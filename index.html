<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Nota privada ‚Äî M√≥dulo</title>
<style>
  :root{
    --bg:#070707;
    --text:#e9e9e9;
    --muted:#9b9b9b;
    --alert:#ff6b6b;
    --green:#6cff8a;
  }
  html,body{height:100%;margin:0;font-family:Consolas,Monaco,monospace;background:var(--bg);color:var(--text);overflow:hidden}
  #inicio{height:100%;display:flex;align-items:center;justify-content:center;background:#f3f3f3}
  .btn{padding:18px 36px;border-radius:10px;border:0;background:#111;color:#fff;font-size:18px;cursor:pointer}
  #terminal{display:none;height:100%;padding:16px 18px;box-sizing:border-box;white-space:pre-wrap;overflow:auto;background:linear-gradient(180deg,#050505,#0c0c0c);font-size:14px;line-height:1.25}
  .dim{color:var(--muted)}
  .alert{color:var(--alert)}
  .green{color:var(--green)}
  #whiteFlash{position:fixed;inset:0;background:#fff;opacity:0;pointer-events:none;z-index:9998;transition:opacity 0.03s linear}
  #modalNotify{position:fixed;right:16px;bottom:16px;background:#111;color:#fff;padding:12px 14px;border-radius:8px;box-shadow:0 6px 30px rgba(0,0,0,0.6);z-index:9999;display:none}
  #stopBtn{position:fixed;left:16px;top:16px;background:#222;color:#fff;padding:8px 12px;border-radius:8px;border:0;z-index:9999;cursor:pointer}
  .big{font-size:15px}
  a.small{color:var(--muted);font-size:12px;text-decoration:none;margin-left:8px}
  .fs-active #terminal{padding:36px}
  /* shake screen visual (complementario a vibraci√≥n f√≠sica) */
  @keyframes screenshake {
    0% { transform: translate(0,0); }
    10% { transform: translate(-2px,1px); }
    20% { transform: translate(2px,-1px); }
    30% { transform: translate(-3px,2px); }
    40% { transform: translate(3px,-2px); }
    50% { transform: translate(0,0); }
    100% { transform: translate(0,0); }
  }
  .shake { animation: screenshake 0.18s infinite linear; }
  /* tiny visual for red pulsing lines */
  .pulse-red {
    display:inline-block;
    box-shadow: 0 0 12px rgba(255,90,90,0.12);
  }
</style>
</head>
<body>

<div id="inicio">
  <button class="btn" id="openBtn">üìÑ Abrir nota privada</button>
</div>

<div id="terminal" role="log" aria-live="polite"></div>

<div id="whiteFlash"></div>
<div id="modalNotify" class="dim"></div>
<button id="stopBtn" title="Detener efectos">‚úï DETENER</button>

<script>
/* ----------------- ELEMENTOS ----------------- */
const openBtn = document.getElementById('openBtn');
const inicio = document.getElementById('inicio');
const terminal = document.getElementById('terminal');
const whiteFlash = document.getElementById('whiteFlash');
const modalNotify = document.getElementById('modalNotify');
const stopBtn = document.getElementById('stopBtn');

stopBtn.style.display = 'none'; // oculto hasta iniciar

/* ----------------- ESTADO GLOBAL ----------------- */
let vibInterval = null;
let flashInterval = null;
let audioCtx = null;
let rumbleOsc = null;
let rumbleGain = null;
let alarmOsc = null;
let alarmGain = null;
let logsInterval = null;
let keepRunning = true;

/* evita salida f√°cil (navegadores controlan esto) */
window.onbeforeunload = () => "Proceso en ejecuci√≥n...";

/* ----------------- GENERADOR DE LOGS (HTML, con colores) ----------------- */
function generateLogStream(){
  const imgs = Array.from({length:300},(_,i)=>`IMG_${3000+i}.jpg`);
  const vids = Array.from({length:90},(_,i)=>`VID_${1100+i}.mp4`);
  const auds = Array.from({length:160},(_,i)=>`AUDIO_${200+i}.ogg`);
  const chatUsers = ['maria','juan','sofia','carlos','luis','ana','paula','dani','sara','alex','laura','ramon'];
  const now = Date.now();

  let step = 0;
  return function pushMore(){
    if(!keepRunning) return;
    const lines = [];
    const batch = 8 + Math.floor(Math.random() * 22); // m√°s l√≠neas por lote
    for(let j=0;j<batch;j++){
      step++;
      const t = new Date(now + step * 1000).toISOString().replace('T',' ').slice(0,19);
      const r = Math.random();
      let text = '';
      if(r < 0.06){
        const user = chatUsers[Math.floor(Math.random()*chatUsers.length)];
        const amount = Math.floor(Math.random()*9500)+1;
        text = `[${t}] [DB] whatsapp/msgstore.db -> lectura completa (mensajes: ${amount})`;
        text = `<span class="green">${escapeHtml(text)}</span>`;
      } else if (r < 0.18){
        const f = imgs[Math.floor(Math.random()*imgs.length)];
        text = `[${t}] [FILE] /storage/DCIM/Camera/${f} -> COPIA OK (size: ${Math.floor(Math.random()*8200)+120}KB)`;
      } else if (r < 0.26){
        const f = vids[Math.floor(Math.random()*vids.length)];
        text = `[${t}] [FILE] /storage/DCIM/Camera/${f} -> COPIA OK (size: ${Math.floor(Math.random()*72000)+5000}KB)`;
      } else if (r < 0.38){
        const f = auds[Math.floor(Math.random()*auds.length)];
        text = `[${t}] [FILE] /storage/WhatsApp/Media/Audio/${f} -> COPIA OK`;
      } else if (r < 0.50){
        const u = chatUsers[Math.floor(Math.random()*chatUsers.length)];
        text = `[${t}] [API] Instagram -> descargar_dms('${u}') -> ${Math.floor(Math.random()*420)} mensajes, adjuntos: ${Math.floor(Math.random()*48)}`;
        text = `<span class="dim">${escapeHtml(text)}</span>`;
      } else if (r < 0.60){
        text = `[${t}] [SYS] Exportando contactos -> contacts_export.vcf (registros: ${Math.floor(Math.random()*1200)+30})`;
      } else if (r < 0.72){
        text = `[${t}] [ZIP] pack_media_part_${Math.floor(Math.random()*28)+1}.zip -> ${Math.floor(Math.random()*98)+2}%`;
      } else if (r < 0.82){
        text = `[${t}] [KEY] tokens/session_${Math.random().toString(36).slice(2,10)} -> token extraido`;
      } else if (r < 0.90){
        text = `<span class="green">[${t}] [NET] upload -> ${Math.floor(Math.random()*98)+1}% velocidad:${Math.floor(Math.random()*42)+1}MB/s</span>`;
      } else {
        text = `<span class="alert pulse-red">[${t}] [CRIT] bypass_firewall -> OK  root_simulated=true</span>`;
      }
      // a√±ade l√≠nea al bloque
      lines.push(text);
    }
    // empuja a la terminal (HTML)
    terminal.innerHTML += lines.join('<br>') + '<br>';
    terminal.scrollTop = terminal.scrollHeight;
  };
}

/* escape simple para seguridad interna (aunque todo es ficticio) */
function escapeHtml(s){
  return s.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;');
}

/* ----------------- VIBRACI√ìN "TEMBLOR" ----------------- */
function startVibrationAndShake(){
  // patr√≥n de vibraci√≥n intenso tipo temblor: r√°fagas cortas y r√°pidas
  if ('vibrate' in navigator ){
    if(vibInterval) clearInterval(vibInterval);
    // cada intervalo disparamos una r√°faga (navegadores pueden ignorar si pesta√±a en fondo)
    vibInterval = setInterval(()=>{
      // r√°faga impredecible para sensaci√≥n de temblor
      const pattern = [
        180,30,140,40,120,30,100,20,80,20,60
      ];
      navigator.vibrate(pattern);
      // adem√°s aplicamos una t√≠mida sacudida visual sincronizada
      document.body.classList.add('shake');
      setTimeout(()=>document.body.classList.remove('shake'), 220);
      // pulsar el rumble audio (si existe)
      pulseRumble();
    }, 420); // cada ~0.42s una r√°faga
  } else {
    // si no hay vibraci√≥n, solo hacemos la sacudida visual y audio
    vibInterval = setInterval(()=>{
      document.body.classList.add('shake');
      setTimeout(()=>document.body.classList.remove('shake'), 220);
      pulseRumble();
    }, 420);
  }
}
function stopVibrationAndShake(){
  if('vibrate' in navigator) navigator.vibrate(0);
  if(vibInterval) clearInterval(vibInterval);
  vibInterval = null;
  document.body.classList.remove('shake');
}

/* ----------------- AUDIO: RUMBLE + ALARMA ----------------- */
function startAudioEngine(){
  try{
    audioCtx = audioCtx || new (window.AudioContext || window.webkitAudioContext)();

    // RUMBLE (baja frecuencia, sutil)
    rumbleOsc = audioCtx.createOscillator();
    rumbleGain = audioCtx.createGain();
    rumbleOsc.type = 'sine';
    rumbleOsc.frequency.value = 65; // 60-80Hz para ruidos de "motor/vibraci√≥n"
    rumbleGain.gain.value = 0.0;
    rumbleOsc.connect(rumbleGain);
    rumbleGain.connect(audioCtx.destination);
    rumbleOsc.start();

    // ALARMA (tono m√°s agudo modulable, bajo volumen)
    alarmOsc = audioCtx.createOscillator();
    alarmGain = audioCtx.createGain();
    alarmOsc.type = 'sawtooth';
    alarmOsc.frequency.value = 620; // tono agudo para sensaci√≥n de alerta
    alarmGain.gain.value = 0.0;
    alarmOsc.connect(alarmGain);
    alarmGain.connect(audioCtx.destination);
    alarmOsc.start();

    // leve fade-in para no explotar los altavoces
    let v=0.0;
    const id = setInterval(()=>{
      v = Math.min(0.06, v + 0.0035);
      // alarma y rumble distintos vol√∫menes
      rumbleGain.gain.value = v * 0.55;
      alarmGain.gain.value = v * 0.65;
      if(v >= 0.06) clearInterval(id);
    }, 90);
  }catch(e){
    console.warn('Audio no disponible.', e);
  }
}
function stopAudioEngine(){
  try{
    if(rumbleOsc){ rumbleOsc.stop(); rumbleOsc.disconnect(); rumbleOsc = null; }
    if(alarmOsc){ alarmOsc.stop(); alarmOsc.disconnect(); alarmOsc = null; }
    if(audioCtx){ audioCtx.close(); audioCtx = null; }
  }catch(e){}
}
/* Pulso corto para sincronizar con vibraci√≥n */
function pulseRumble(){
  if(!rumbleGain) return;
  // aumento r√°pido y ca√≠da para sensaci√≥n de golpe
  const now = audioCtx.currentTime;
  rumbleGain.gain.cancelScheduledValues(now);
  rumbleGain.gain.setValueAtTime(rumbleGain.gain.value, now);
  rumbleGain.gain.linearRampToValueAtTime(0.14, now + 0.02);
  rumbleGain.gain.linearRampToValueAtTime(0.0, now + 0.18);
  // tambi√©n pulso alarma aguda muy breve
  if(alarmGain){
    alarmGain.gain.cancelScheduledValues(now);
    alarmGain.gain.setValueAtTime(alarmGain.gain.value, now);
    alarmGain.gain.linearRampToValueAtTime(0.06, now + 0.02);
    alarmGain.gain.linearRampToValueAtTime(0.0, now + 0.12);
  }
}

/* ----------------- FLASH BLANCO ----------------- */
function startWhiteFlashes(){
  if(flashInterval) clearInterval(flashInterval);
  flashInterval = setInterval(()=>{
    whiteFlash.style.opacity = '0.98';
    setTimeout(()=>whiteFlash.style.opacity='0', 60 + Math.random()*120);
  }, 380 + Math.random()*300);
}
function stopWhiteFlashes(){
  if(flashInterval) clearInterval(flashInterval);
  whiteFlash.style.opacity = '0';
}

/* ----------------- NOTIFICACIONES IN-APP O NATIVE ----------------- */
function showInPageNotice(msg){
  modalNotify.innerText = msg;
  modalNotify.style.display = 'block';
  modalNotify.style.opacity = '1';
  setTimeout(()=>{ modalNotify.style.opacity = '0'; setTimeout(()=>modalNotify.style.display='none',400); }, 2600 + Math.random()*2200);
}
function requestAndSendNotification(title, body){
  if(!("Notification" in window)) { showInPageNotice(body); return; }
  if(Notification.permission === 'granted'){
    new Notification(title, {body, tag:'intensa-notif'});
  } else if(Notification.permission !== 'denied'){
    Notification.requestPermission().then(p=>{
      if(p === 'granted'){ new Notification(title, {body, tag:'intensa-notif'}); }
      else showInPageNotice(body);
    });
  } else {
    showInPageNotice(body);
  }
}

/* ----------------- MODO PERSISTENTE (EFECTOS + LOGS) ----------------- */
function startPersistentMode(){
  if(document.documentElement.requestFullscreen){
    document.documentElement.requestFullscreen().catch(()=>{});
  }
  document.body.classList.add('fs-active');
  stopBtn.style.display = 'inline-block';

  // efectos
  startAudioEngine();
  startVibrationAndShake();
  startWhiteFlashes();

  // notificaciones peri√≥dicas que advierten "No apagar dispositivo"
  const notifLoop = setInterval(()=>{
    if(!keepRunning){ clearInterval(notifLoop); return; }
    requestAndSendNotification('ATENCI√ìN', 'Proceso cr√≠tico en curso. No apagar el dispositivo.');
    showInPageNotice('PROCESO CR√çTICO ‚Äî NO APAGUE EL DISPOSITIVO');
  }, 5000 + Math.random()*8000);

  // logs persistentes
  const push = generateLogStream();
  push(); // burst inicial
  logsInterval = setInterval(()=>{
    if(!keepRunning) return;
    // empuja m√∫ltiples veces de forma variable
    push();
    if(Math.random()>0.6) push();
    if(Math.random()>0.92) {
      // inyecta l√≠nea roja muy cr√≠tica
      const t = new Date().toISOString().replace('T',' ').slice(0,19);
      terminal.innerHTML += `<span class="alert pulse-red">[${t}] [CRIT] TRANSFERENCIA FINAL - paquete_critical.bin -> 100%</span><br>`;
      terminal.scrollTop = terminal.scrollHeight;
    }
  }, 800);
}

/* ----------------- DETENER TODO (escape seguro) ----------------- */
function stopAll(){
  keepRunning = false;
  // stop intervals and effects
  stopVibrationAndShake();
  stopWhiteFlashes();
  stopAudioEngine();
  if(logsInterval) clearInterval(logsInterval);
  window.onbeforeunload = null;
  document.body.classList.remove('fs-active');
  try{ if(document.exitFullscreen) document.exitFullscreen().catch(()=>{}); }catch(e){}
  stopBtn.style.display = 'none';
  modalNotify.style.display = 'none';
  // deja la terminal con estado final (sin revelar "broma")
  terminal.innerHTML += '<br><span class="dim">[SYSTEM] procesos detenidos por el usuario</span><br>';
  terminal.scrollTop = terminal.scrollHeight;
}

/* ----------------- EVENTOS UI ----------------- */
openBtn.addEventListener('click', ()=>{
  inicio.style.display = 'none';
  terminal.style.display = 'block';
  // petici√≥n de notificaciones (silenciosa)
  if("Notification" in window && Notification.permission === 'default'){
    Notification.requestPermission().then(()=>{});
  }
  // Intro controlado (m√°s textual en blanco pero con toques color)
  const introLines = [
    '[BOOT] Arrancando m√≥dulo remoto...',
    '[SYS] Comprobando integridad del kernel...',
    '[NET] Inicializando stack de red...',
    '[NET] Buscando redes y dispositivos en LAN...',
    `[NET] IP detectada -> 192.168.${Math.floor(Math.random()*255)}.${Math.floor(Math.random()*255)}`,
    '[AUTH] Elevando privilegios (simulado)...',
    '[OK] Acceso temporal concedido',
    '[SCAN] Escaneando aplicaciones instaladas: whatsapp, instagram, gallery, storage, contacts',
    '[PROC] Montando drivers virtuales...',
    '[DB] Abriendo whatsapp/msgstore.db ...',
    '[DB] Leyendo √≠ndices de mensajes...',
    '[DB] Indexes OK, iterando tablas...',
    '[SYNC] Comenzando extracci√≥n masiva de multimedia y chats...'
  ];
  let k = 0;
  function writeIntro(){
    if(k<introLines.length){
      terminal.innerHTML += escapeHtml(introLines[k]) + '<br>';
      terminal.scrollTop = terminal.scrollHeight;
      k++;
      setTimeout(writeIntro, 240);
    } else {
      // iniciar modo persistente
      startPersistentMode();
    }
  }
  writeIntro();
});

stopBtn.addEventListener('click', ()=>{
  const ok = confirm('Detener todos los efectos y salir?');
  if(ok) stopAll();
});

/* detener al ocultarse la p√°gina (por seguridad) */
window.addEventListener('pagehide', ()=>{ stopAll(); });

</script>
</body>
</html>
